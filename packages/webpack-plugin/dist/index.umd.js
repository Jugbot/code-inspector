(function(c,u){typeof exports=="object"&&typeof module<"u"?module.exports=u(require("code-inspector-core"),require("path")):typeof define=="function"&&define.amd?define(["code-inspector-core","path"],u):(c=typeof globalThis<"u"?globalThis:c||self,c.WebpackCodeInspectorPlugin=u(c.codeInspectorCore,c.path))})(this,function(c,u){"use strict";const d=(s,e)=>{var r;const o=(s==null?void 0:s.compiler)||s,t=(r=o==null?void 0:o.options)==null?void 0:r.module;((t==null?void 0:t.rules)||(t==null?void 0:t.loaders)||[]).push({test:/\.(vue|jsx|tsx)$/,use:[u.resolve(__dirname,"./loader.js")],enforce:"pre"}),typeof e=="function"&&e()},f=(s,e)=>{const o=s.lastIndexOf("</html>");return o>-1&&(s=s.slice(0,o)+`
${e}
`+s.slice(o)),s},h=(s,e,o)=>{const t=Object.keys(e).filter(n=>/\.html$/.test(n));t.length?t.forEach(n=>{const r=e[n].source(),i=f(r,s);e[n]={source:()=>i,size:()=>i.length}}):o&&o(new Error("webpack-code-inspector-plugin Cannot find output HTML file"))};class l{constructor(e){this.options=e||{}}apply(e){var t;if(((t=e==null?void 0:e.options)==null?void 0:t.mode)!=="development")return;const o=n=>c.getInjectCode(n,{...this.options||{}});e.hooks&&this.handleWebpackAbove4(e,o)}handleWebpackAbove4(e,o){e.hooks.watchRun.tap("WebpackCodeInspectorLoader",d);const t=e.options.plugins.find(n=>n.constructor.name==="HtmlWebpackPlugin");t?e.hooks.compilation.tap("WebpackCodeInspectorPlugin",n=>{let r=n.hooks.htmlWebpackPluginAfterHtmlProcessing;r||(r=t.constructor.getHooks(n).beforeEmit),r.tapAsync("WebpackCodeInspectorPlugin",(i,p)=>{const a=c.normalizePath(n.options.context);c.startServer(k=>{i.html=f(i.html,o(k)),p(null,i)},a)})}):e.hooks.emit.tapAsync("WebpackCodeInspectorPlugin",(n,r)=>{const i=c.normalizePath(n.options.context);c.startServer(p=>{const{assets:a}=n;h(o(p),a,r),r()},i)})}}return l});
